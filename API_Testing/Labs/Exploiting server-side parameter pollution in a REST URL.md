1. Reset a password to the administrator;

![](/static/img/Pasted_image_20231206171753.png)

2. ![](/static/img/Pasted_image_20231206172026.png)
3. Change the username values between ```username=carlos%3f``` or ```username=carlos%23``` and verify the contents of the response

![](/static/img/Pasted_image_20231206172228.png)

![](/static/img/Pasted_image_20231206172247.png)

4. This suggests that the server may have placed the input in the path of a server-side request, and that the fragment has truncated some trailing data. Observe that the message also refers to an API definition.
5.  Incrementally add further `../` sequences until you reach `../../../../%23` Notice that this returns a `Not found` response. This indicates that you've navigated outside the API root.

![](/static/img/Pasted_image_20231206172519.png)

6. Now you can search for common api docs paths. You can use my gist here [paths](https://gist.github.com/rodnt/250dd33af97d228cc94cd11504abef06)

![](/static/img/Pasted_image_20231206172752.png)

7. Verify the contents of ```static/js/forgotPassword.js``` and notice the path `1. `/forgot-password?passwordResetToken=${resetToken}`
8. After analyze the content of response from step step 6. Send the following request:
![](/static/img/Pasted_image_20231206173244.png)
9. There is a protection, you need a bypass. Fuzzing a little, and find the api root at `/api/internal/v1/users/carlos` there is a `v2`, but it will not work with `field/passwordResetToken%23` bypass

![](/static/img/Pasted_image_20231206204310.png)

10. Send the following request and gonna solve the lab!

![](/static/img/Pasted_image_20231206204449.png)


11. Copy the endpoint at the .js from step 7. And paste the token from step 10:

![](/static/img/Pasted_image_20231206204641.png)

12. Delete carlos :-)

![](/static/img/Pasted_image_20231206204736.png)

